To reproduce error:


*On rzansel, 1 node (lalloc 1 -W 60)


1) make miniAppGPU
2) lrun -n 1 miniAppGPU 500 128 1 128 1 128 1



Expected error:
Current map  [0x7fffffff7e90, 0x7fffffff7ef7] len=104 :
    Src: miniApp.f90 Line: 294 Column: 48 Listitem: tmp(pointer)
Previous map [0x7fffffff7e30, 0x7fffffff7e97] len=104 :
    <No description available>
1587-168 Encountered a map that partially includes the memory of a prior map on the target device 0. The encountered map starts at host address 0x7fffffff7e90 and the prior map starts at host address 0x7fffffff7e30.  The program will stop.

This error appears to be an issue with dependencies not being tracked correctly when returning from a subroutine.

Best guess on cause is that the 'nowait' on the openmp target exit data map inside the two subroutines 'EOS' and 'divFoo' is causing an issue.
The code will run if barriers are introduced at the end of these two subroutines.
